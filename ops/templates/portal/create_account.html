<style>
    .btn-default.btn-on.active{background-color: #337ab7;color: white;}
    .btn-default.btn-off.active{background-color: #337ab7;color: white;}
    .stepwizard-step {width:25%;}
</style>
<div class="modal create-acc-modal" tabindex="-1" role="dialog" aria-labelledby="appmodal" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content col-xs-12">
        <div class="modal-header">
            <strong class="modal-title" id="exampleModalLabel">Create An Account</strong>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
        </div>
          <div class="modal-body col-xs-12">
            <div class="">
                <div class="stepwizard">
                    <div class="stepwizard-row setup-panel">
                        {% if user_data.userType == "White Label Partner" %}
                        <div class="stepwizard-step col-xs-3"> 
                            <a href="#step-1" type="button" class="btn btn-warning btn-circle">
                            <i class="fa fa-user"></i>
                            </a>
                            <p><small>Account Type</small></p>
                        </div>
                        {% endif %}
                        <div class="stepwizard-step col-xs-3"> 
                            {% if user_data.userType == "White Label Partner" %}
                            <a href="#step-2" type="button" class="btn btn-default btn-circle">
                            {% else  %}
                            <a href="#step-2" type="button" class="btn btn-warning btn-circle">
                            {% endif %}
                            <i class="fa fa-info"></i>
                            </a>
                            <p><small>Basic</small></p>
                        </div>
                        {% if user_data.userType == "White Label Partner" %}
                        <div class="stepwizard-step col-xs-3 wl-data"> 
                            <a href="#step-3" type="button" class="btn btn-default btn-circle">
                            <i class="fa fa-address-card"></i>
                            </a>
                            <p><small>Contact</small></p>
                        </div>
                        {% endif %}
                        <div class="stepwizard-step col-xs-3"> 
                            <a href="#step-4" type="button" class="btn btn-default btn-circle">
                            <i class="fa fa-cog"></i>
                            </a>
                            <p><small>Others</small></p>
                        </div>
                        <div class="stepwizard-step col-xs-3 pricing-tab" style="display:none"> 
                            <a href="#step-5" type="button" class="btn btn-default btn-circle"><i class="fa fa-money"></i></a>
                            <p><small>Pricing</small></p>
                        </div>
                    </div>
                </div>
                
                <form role="form" class="creat-acc-form" action="{{request.META.HTTP_NAME }}/api/createAccount" method="post">
                    <div class="panel panel-primary setup-content" id="step-1">
                        <div class="panel-heading">
                             <h3 class="panel-title">Select Account Type</h3>
                        </div>
                        <div class="panel-body">
                            <div class="btn-group account-type" data-toggle="buttons">
                              <label class="btn btn-default btn-on btn-lg active">
                              <input type="radio" value="wl" name="acc_type" checked="checked">White Label</label>
                              <label class="btn btn-default btn-off btn-lg">
                              <input type="radio" value="ws" name="acc_type">Wholesale</label>
                            </div>
                            <div class="form-group">
                                <h5 class="acc-detail">Whitelabel Account Details ...</h5>
                            </div>
                            <button class="btn btn-primary nextBtn pull-right" type="button">Next</button>
                        </div>
                    </div>
                    <div class="panel panel-primary setup-content" id="step-2">
                        <div class="panel-heading">
                             <h3 class="panel-title">Basic Information</h3>
                        </div>
                        <div class="panel-body">
                            <div class="form-group">
                                <label class="control-label">Client Name</label>
                                <input maxlength="100" type="text" name="client_name" class="form-control" placeholder="Enter Client Name" />
                            </div>
                             {% if user_data.userType == "White Label Partner" %}
                            <div class="form-group wl-data">
                                <label class="control-label">Trading Name</label>
                                <input maxlength="100" type="text" name="trade_name" class="form-control" placeholder="Enter Trading Name" />
                            </div>
                            <div class="form-group wl-data">
                                <label class="control-label">Email</label>
                                <input maxlength="200" type="text" name="email" class="form-control" placeholder="Enter Email" />
                            </div>
                            <div class="form-group wl-data">
                                <label class="control-label">Client Contact</label>
                                <input maxlength="200" type="text" name="contact" class="form-control" placeholder="Enter Client Contact" />
                            </div>
                            {% endif %}
                            <button class="btn btn-primary prevBtn pull-left" type="button">Previous</button>
                            <button class="btn btn-primary nextBtn pull-right" type="button">Next</button>
                            
                        </div>
                    </div>
                    
                    {% if user_data.userType == "White Label Partner" %}
                    <div class="panel panel-primary setup-content" id="step-3">
                        <div class="panel-heading">
                             <h3 class="panel-title">Contacts</h3>
                        </div>
                        <div class="panel-body">
                            <div class="row">
                                <div class="form-group col-xs-12 col-sm-12 col-md-4">
                                    <label class="control-label">Postal Address</label>
                                    <input maxlength="200" type="text" name="post_address_1" class="form-control" placeholder="Postal Address 1" />
                                </div>
                                <div class="form-group col-xs-12 col-sm-12 col-md-4">
                                    <label class="control-label"><br></label>
                                    <input maxlength="200" type="text" name="post_address_2" class="form-control" placeholder="Postal Address 2" />
                                </div>
                                <div class="form-group col-xs-12 col-sm-12 col-md-4">
                                    <label class="control-label"><br></label>
                                    <input maxlength="200" type="text" name="post_address_3" class="form-control" placeholder="Postal Address 3" />
                                </div>
                            </div>
                            <div class="row">
                                <div class="form-group col-xs-12 col-sm-12 col-md-6">
                                    <label class="control-label">Physical Address</label>
                                    <input maxlength="200" type="text" name="phy_address_1" class="form-control" placeholder="Physical Address 1" />
                                </div>
                                <div class="form-group col-xs-12 col-sm-12 col-md-6">
                                    <label class="control-label"><br></label>
                                    <input maxlength="200" type="text" name="phy_address_2" class="form-control" placeholder="Physical Address 2" />
                                </div>
                            </div>
                            <div class="row">
                                <div class="form-group col-xs-12 col-sm-12 col-md-6">
                                    <label class="control-label">Phone Number</label>
                                    <input maxlength="200" type="text" name="phone_num_1" class="form-control" placeholder="Phone Number 1" />
                                </div>
                                <div class="form-group col-xs-12 col-sm-12 col-md-6">
                                    <label class="control-label"><br></label>
                                    <input maxlength="200" type="text" name="phone_num_2" class="form-control" placeholder="Phone Number 2" />
                                </div>
                            </div>
                            <div class="row">
                                <div class="form-group col-xs-12 col-sm-12 col-md-6">
                                    <label class="control-label">Fax Number</label>
                                    <input maxlength="200" type="text" name="fax_num" class="form-control" placeholder="Fax Number" />
                                </div>
                            </div>
                            <button class="btn btn-primary prevBtn pull-left" type="button">Previous</button>
                            <button class="btn btn-primary nextBtn pull-right" type="button">Next</button>
                        </div>
                    </div>
                    {% endif %}
                    
                    <div class="panel panel-primary setup-content" id="step-4">
                        <div class="panel-heading">
                             <h3 class="panel-title">Others</h3>
                        </div>
                        <div class="panel-body">
                            <div class="form-group">
                                <label class="control-label">Default Pricing</label>
                                <input type="checkbox" name="default_price" checked="checked" /> &nbsp;&nbsp;&nbsp;&nbsp;
                            </div>
                            <div class="form-group">
                                <label class="control-label">Notes</label>
                                <textarea maxlength="200" type="text" name="notes" class="form-control" ></textarea>
                            </div>
                            <div class="pull-left acc-msg"></div>
                            <button class="btn btn-primary prevBtn pull-left" type="button">Previous</button>
                            <button type="submit" class="btn btn-primary pull-right create-acc-btn">Create Now</button>
                        </div>
                    </div>

                    <div class="panel panel-primary setup-content" id="step-5">
                        <div class="panel-heading"><h3 class="panel-title">Default Pricing</h3></div>
                        <div class="panel-body">
                             <div class="col-xs-12 pricing-info ">
                                 
                              </div>
                            <button class="btn btn-primary prevBtn pull-left" type="button">Previous</button>
                            <button class="btn btn-primary create-acc pull-right" type="submit">Create Now</button>
                        </div>
                    </div>

                    <div class="modal-footer col-xs-12">
                        <div class="alert creat-acc-alert pull-left" style="display:none;padding:6px;margin:0">
                          
                        </div>
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
  </div>
</div>

<style>
    /* Latest compiled and minified CSS included as External Resource*/

/* Optional theme */

/*@import url('//netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap-theme.min.css');*/

.stepwizard-step p {
    margin-top: 0px;
    color:#666;
}
.stepwizard-row {
    display: table-row;
}
.stepwizard {
    display: table;
    width: 100%;
    position: relative;
}
.stepwizard-step button[disabled] {
    /*opacity: 1 !important;
    filter: alpha(opacity=100) !important;*/
}
.stepwizard .btn.disabled, .stepwizard .btn[disabled], .stepwizard fieldset[disabled] .btn {
    opacity:1 !important;
    color:#bbb;
}
.stepwizard-row:before {
    top: 14px;
    bottom: 0;
    position: absolute;
    content:" ";
    width: 100%;
    height: 1px;
    background-color: #ccc;
    z-index: 0;
}
.stepwizard-step {
    display: table-cell;
    text-align: center;
    position: relative;
}
.btn-circle {
    width: 30px;
    height: 30px;
    text-align: center;
    padding: 8px 0;
    font-size: 12px;
    line-height: 1.428571429;
    border-radius: 15px;
}
</style>

<script>
    $(document).ready(function () {

    var navListItems = $('div.setup-panel div a'),
        allWells = $('.setup-content'),
        allNextBtn = $('.nextBtn');

    allWells.hide();

    navListItems.click(function (e) {
        e.preventDefault();
        var $target = $($(this).attr('href')),
            $item = $(this);

        if (!$item.hasClass('disabled')) {
            navListItems.removeClass('btn-warning').addClass('btn-default');
            $item.addClass('btn-warning');
            allWells.hide();
            $target.show();
            $target.find('input:eq(0)').focus();
        }
    });

    // allNextBtn.click(function () {
    $(document).on('click','.nextBtn', function(e){
        var curStep = $(this).closest(".setup-content"),
            curStepBtn = curStep.attr("id"),
            nextStepWizard = $('div.setup-panel div a[href="#' + curStepBtn + '"]').parent().next().children("a"),
            curInputs = curStep.find("input[type='text']:visible,input[type='url']:visible"),
            isValid = true;

        $(".form-group").removeClass("has-error");
        for (var i = 0; i < curInputs.length; i++) {
            if (!curInputs[i].validity.valid) {
                isValid = false;
                $(curInputs[i]).closest(".form-group").addClass("has-error");
            }
        }

        if (isValid) {
            if(!(nextStepWizard.parent()).is(':visible'))
                nextStepWizard = nextStepWizard.parent().next().children("a");

            console.log(nextStepWizard);
            nextStepWizard.removeAttr('disabled').removeClass('disabled').trigger('click');
           
        }
    });


    // allNextBtn.click(function () {
    $(document).on('click','.prevBtn', function(e){
        var curStep = $(this).closest(".setup-content"),
        curStepBtn = curStep.attr("id"),
        nextStepWizard = $('div.setup-panel div a[href="#' + curStepBtn + '"]').parent().prev().children("a");
       
        nextStepWizard.removeAttr('disabled').removeClass('disabled').trigger('click');
    });

    $('div.setup-panel div a.btn-warning').trigger('click');

   
    $(document).on('submit','.creat-acc-form',function(e){
        e.preventDefault();
        var form=$(this);
        $.ajax({
          type: "POST",
          url: form.attr( 'action' ),
          // data: form.serialize(),
          data:  new FormData(this),
          contentType: false,
          cache: false, 
          processData:false,
          beforeSend:function(){
            $('.create-acc-btn').html('Creating <i class="fa fa-spinner fa-spin"></i>');
          },
          success: function( data ) {
            var data = JSON.parse(data);
            $('div.setup-panel a:not(:first)').removeClass('btn-warning');
            $('div.setup-panel a:first').addClass('btn-warning').trigger('click');
            $('.create-acc-btn').html('Create');
            $('.creat-acc-alert').html(data['message']).addClass('alert-'+data['alert']).show().delay(5000).fadeOut();
            form.find('.setup-content:first').show();
            form.find('.setup-content:not(:first)').hide();
            form.find('input:not(input[type="radio"]), textarea').val('');
          },
          error:function(){

          }
      });
    })

    // select account type
    $(document).on('change','input[name="acc_type"]', function(e){
        var accType = $(this).val();
        if(accType == 'wl')
            $('.wl-data').show();
        else 
            $('.wl-data').hide();
    })

    $(document).on('click','.account-type label', function(e){
        $(this).parents('.account-type').find('input').removeAttr('checked');
        var $input = $(this).find('input');
        $input.attr('checked', 'checked');
        if($input.val() == 'ws')
            $('.acc-detail').html('Wholesale account details ...');
        else $('.acc-detail').html('Whitelabel account details ...');

    })

    $(document).on('change','input[name="default_price"]', function(e){
        if(!this.checked){
            $('.stepwizard-step').css('width','20%');
            $('.pricing-tab').show();
        }
        else {
            $('.stepwizard-step').css('width','25%');
            $('.pricing-info').find('input').val("");
            $('.pricing-tab').hide();
        }

        var $createbtn = $('.create-acc-btn');
        $('.create-acc').addClass('create-acc-btn').removeClass('create-acc nextBtn').attr('type','submit').html('Create Now');
        $createbtn.addClass('nextBtn create-acc').removeClass('create-acc-btn').attr('type','button').html('Next');
    })

    $(document).on('shown.bs.modal','.create-acc-modal', function(e) {
      $.ajax({
          url: '{{ request.META.HTTP_NAME }}/api/default_prices',
          type: 'POST',
          data: {
              csrfmiddlewaretoken: '{{ csrf_token }}',
          },
      }).done(function(response){
        $('.pricing-info').html(response);
      }); 
    })

});
</script>

